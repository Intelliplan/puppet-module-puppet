# This file is being maintained by Puppet.
# DO NOT EDIT

# SVN

#<VirtualHost <% if defined? puppetrepo_listen_ip %><%= puppetrepo_listen_ip %><% else %><%= ipaddress %><% end %>:80>
#    ServerName puppet.<%= pop %>.yourdomain.tld
#    DocumentRoot /var/www/html
#    CustomLog /var/log/httpd/access_log-puppet.yourdomain.tld combined
#
#    RewriteEngine ON
#    RewriteRule ^(.*)$ https://puppet.yourdomain.tld/$1 [R=301,L]
#</VirtualHost>
#
<VirtualHost  <% if defined? puppetrepo_http_listen_ip_public %><%= puppetrepo_http_listen_ip_public %><% else %><%= ipaddress_eth0 %><% end %>:443>
    ServerName puppet.<%= pop %>.yourdomain.tld
    DocumentRoot /var/www/html

    AddType application/x-x509-ca-cert .crt
    AddType application/x-pkcs7-crl    .crl

    SSLEngine on
    SSLProtocol all -SSLv2
    SSLCipherSuite ALL:!ADH:!EXPORT56:RC4+RSA:+HIGH:+MEDIUM:+LOW:+SSLv2:+EXP:+eNULL
    SSLCertificateFile /etc/pki/tls/certs/your_cert.pem
    SSLCertificateKeyFile /etc/pki/tls/private/your_key.pem
    SSLSessionCacheTimeout  300
    SSLVerifyDepth  10
    BrowserMatch ".*MSIE.*" \
        nokeepalive ssl-unclean-shutdown \
        downgrade-1.0 force-response-1.0
    CustomLog /var/log/httpd/ssl_request.log \
        "%t %h %{SSL_PROTOCOL}x %{SSL_CIPHER}x \"%r\" %b"

        <Directory /opt/<%= lsbProvider %>/svn/>
        Options Indexes FollowSymLinks MultiViews
        AllowOverride None
        Order allow,deny
        allow from all
    </Directory>

    <Location /puppet>
        DAV svn
        SVNPath /opt/<%= lsbProvider %>/svn/puppet
        SVNListParentPath on
        AuthType Basic
        AuthName "Puppet Repository"
        AuthUserFile /etc/httpd/conf/svn-access
        Require valid-user
    </Location>
</VirtualHost>

<VirtualHost <% if defined? puppetrepo_http_listen_ip_private %><%= puppetrepo_http_listen_ip_private %><% else %><%= ipaddress_eth0_0 %><% end %>:80>
    ServerName puppet.<%= pop %>.yourdomain.priv
    DocumentRoot /var/www/html
    CustomLog /var/log/httpd/access_log-puppet.yourdomain.tld combined

    <Directory /opt/<%= lsbProvider %>/svn/>
        Options Indexes FollowSymLinks MultiViews
        AllowOverride None
        Order allow,deny
        allow from all
    </Directory>

    <Location /puppet>
        DAV svn
        SVNPath /opt/<%= lsbProvider %>/svn/puppet
        SVNListParentPath on
    </Location>
</VirtualHost>

<VirtualHost  <% if defined? puppetrepo_http_listen_ip_public %><%= puppetrepo_http_listen_ip_public %><% else %><%= ipaddress_eth0 %><% end %>:80>
    ServerName puppet.<%= pop %>.yourdomain.tld
    DocumentRoot /var/www/html
    CustomLog /var/log/httpd/access_log-puppet.yourdomain.tld combined

    <Directory /opt/<%= lsbProvider %>/svn/>
        Options Indexes FollowSymLinks MultiViews
        AllowOverride None
        Order allow,deny
        allow from all
    </Directory>

    <Location /puppet>
        DAV svn
        SVNPath /opt/<%= lsbProvider %>/svn/puppet
        SVNListParentPath on
    </Location>
</VirtualHost>
